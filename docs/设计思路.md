## Local Project Manage -LPM

### 1 功能设计

#### 1.1 项目管理

区域销售中心的

项目的主要操作包括：项目立项，项目中止，项目信息维护。

**项目管理的主要目的：在系统中维护一张信息准确、完整的项目全景台帐。**

#### 1.2 人员管理

人员管理的功能比较简单，主要是对人员信息进行基本的维护。

#### 1.3 产品/服务管理

产品管理的功能更为简单，主要要求是维护公司产品的基本型号和对外销售的标准名称列表。必要时进行状态标注。

产品信息的主要层级有：

(1)产品系列-->产品名称-->产品型号

(2)以上唯一确定一产品对应一产品编码（公司内部名称存货编码，为9位数字字符串，具体编码含义不详）

**公司的产品库信息 需要专门整理，此项工作的工作量巨大。**



------



### 2 系统设计

#### 2.1 系统设计边界条件

√ 系统需要考虑与公司OA系统的充分对接。

√ 系统不使用C/S结构，需要使用本地数据库实现集中管理，同时与各分支机构通过数据文件进行交换数据

#### 2.2 使用用户分析

主要用户角色 User Roles，在系统中简写为UR：

（1）公司领导 UR-leader：主要查看系统中的报表及汇总信息，跟踪项目总体进展；

（2）项目管理员UR-manager：区域中心综合部人员，用于维护系统中项目、人员、产品等基本信息；以及下级数据的导入

（3）销售人员UR-seller：主要通过EXCEL文件与系统进行数据交换，销售人员不直接使用系统。

#### 2.3 菜单设计

| 文件           | 汇总报表   | 项目管理       | 人员管理       | 产品/服务管理     | 帮助     |
| :------------- | ---------- | -------------- | -------------- | ----------------- | -------- |
| 用户管理       | 项目仪表盘 | 新项目登录     | 新人员登录     | 新产品/服务登录   | 操作说明 |
| 数据库备份     |            | 项目信息维护   | 人员信息修改   | 产品/服务信息修改 | 关于     |
| ----分割线---- |            | ----分割线---- | 人员注销       | 产品停产/服务中止 |          |
| 选项           |            | 项目信息浏览   | ----分割线---- | ----分割线----    |          |
| 退出           |            |                | 人员信息浏览   | 产品/服务信息浏览 |          |
|                |            |                |                |                   |          |
|                |            |                |                |                   |          |
|                |            |                |                |                   |          |

#### 2.4 设计原则

√ 系统使用HTML格式统一输出各类报表，为以后扩展保留足够的灵活性。

√ 系统中除数量类、日期类使用数量和日期类型数据，其它一律使用字符串类型。

√  **使用EXCEL文件作为数据维护的基本方式，不再提供数据增删改查的图形界面。**

#### 2.5 使用类库

(1) 用户界面使用wxPython

(2) 内部操作数据使用pandas

(3) 涉及操作EXCEL使用openpyxl

#### 2.6 数据分布式处理

整个系统分为中心节点（部署在公司总部）和分发数据表（分发到各个销售员手中）

数据库选型使用SQlite，存储在中心节点，保存系统全部数据。在必要时可由系统中抽取数据进行**分发操作**，分发完毕后，普通销售进行填写，再返回，进行**汇入操作**。

需要处理的核心问题：

（1）原始数据的进入，需要单独编制导入

（2）数据库表格的维护基本界面设计和CURD操作

#### 2.7 导出导入表的构建思路

为避免项目CURD和多产品对照的相互影响，建议报备时分开进行，







------



### 3 数据设计

#### 3.1 技术选型

##### 3.1.1 中心数据库

公司总部数据库使用经典本地数据库SQLite，采取单数据库文件形式存储，满足安全保密需求，同时处理备份简单易用。

##### 3.1.2 数据交换文件

公司总部与分支机构数据交换采用EXCEL文件进行，符合继往的操作习惯，EXCEL功能完全可以满足需求，应对临时需求变更灵活。

3.1.3 设计要点

（1）数据交换文件应根据人员进行筛选，提供项目表、项目产品对应信息表。





#### 3.2 数据描述

##### 3.2.1 项目相关数据

项目编号自项目立项之日起形成，直至项目完成，不论中间项目取消、中止或状态发生变化，项目编号均不发生变化。

基于唯一项目编号，项目编号为4位年份+6位流水码，例如：2020000001

##### 3.2.2 人员相关数据

对于公司而言，每一名人员均有唯一人员编号与其相对应，因此人员管理的主要依据为人员编号（staff no或seller no），在系统中简写为sno。

==公司内部将sno设定为不定长的整数，考虑到比较的稳定性，系统将sno默认为字符串类型，公司OA中导出的sno均转化为字符串处理。==

##### 3.2.3 产品/服务相关数据

产品/服务数据表中保留价格字段，便于以后扩展。



#### 3.3 数据库结构

数据库采用单一文件存储，文件名为：lpm_c.db ，其中LPM表示本地项目管理，C表示中心节点。

##### 3.3.1 系统用户表 T_Users

系统用户表，分别标明UR，软件中通过角色进行权限控制。

| 字段名     | 字段类型 | 含义         | 备注           |
| ---------- | -------- | ------------ | -------------- |
| uid        | TEXT     | 用户ID       |                |
| name       | TEXT     | 用户名       |                |
| pwd        | TEXT     | 口令         | 经加密后的口令 |
| UR_leader  | TEXT     | 领导角色     | 取值为bool型   |
| UR_manager | TEXT     | 管理人员角色 | 取值为bool型   |
| UR_seller  | TEXT     | 销售人员角色 | 取值为bool型   |

表格样例：

| uid  | name   | pwd            | UR-leader | UR-manager | UR-seller |      |
| ---- | ------ | -------------- | --------- | ---------- | --------- | ---- |
| 1    | 管理员 | (加密后的口令) | true      | true       | true      |      |
| 2    | 沈晶   | (加密后的口令) | true      | false      | false     |      |
| 3    |        |                |           |            |           |      |

##### 3.3.2 人员信息表 T_Staffs

| 字段名     | 字段类型 | 含义     | 备注                                                 |
| ---------- | -------- | -------- | ---------------------------------------------------- |
| sno        | TEXT     | 人员编号 | 与公司OA系统保持一致                                 |
| name       | TEXT     | 姓名     |                                                      |
| gender     | TEXT     | 性别     |                                                      |
| id_number  | TEXT     | 身份证号 |                                                      |
| email      | TEXT     | 电子邮件 |                                                      |
| cell_phone | TEXT     | 移动电话 |                                                      |
| office_tel | TEXT     | 办公电话 |                                                      |
| branch     | TEXT     | 分支机构 |                                                      |
| dept       | TEXT     | 部门     |                                                      |
| post       | TEXT     | 职位     |                                                      |
| title      | TEXT     | 任命职务 |                                                      |
| s_type     | TEXT     | 人员类别 | 对应职能字段，staff_type包括：综合、售前、售后、销售 |
| remarks    | TEXT     | 备注     |                                                      |
|            |          |          |                                                      |

##### 3.3.3 项目信息表 T_Projects

| 字段名         | 字段类型 | 含义         | 备注                 |
| -------------- | -------- | ------------ | -------------------- |
| pid            | TEXT     | 项目ID       |                      |
| name           | TEXT     | 项目名称     |                      |
| p_no           | TEXT     | 项目编码     | 公司内部使用项目编码 |
| p_type         | TEXT     | 项目类型     | pipeline或非pipeline |
| final_client   | TEXT     | 最终用户     |                      |
| partner        | TEXT     | 合作伙伴     |                      |
| amount         | REAL     | 项目金额     |                      |
| phase          | TEXT     | 项目阶段     |                      |
| plan_sign_time | TEXT     | 预计签约时间 |                      |
| sno            | TEXT     | 人员编号     |                      |
| remarks        | TEXT     | 备注         |                      |
|                |          |              |                      |

##### 3.3.4 产品服务信息表 T_Products

产品服务信息表，此处product包括产品和服务

| 字段名      | 字段类型 | 含义              | 备注                   |
| ----------- | -------- | ----------------- | ---------------------- |
| pdid        | TEXT     | 产品/服务编号     | 对应OA系统中的存货编码 |
| name        | TEXT     | 产品/服务名称     |                        |
| series      | TEXT     | 产品/服务系列     |                        |
| model       | TEXT     | 产品/服务规格型号 |                        |
| pd_code     | TEXT     | 产品代码          |                        |
| status      | TEXT     | 状态              |                        |
| stock_count | INTEGER  | 存货数量          |                        |
| price       | REAL     | 价格              |                        |
| remarks     | TEXT     | 备注              |                        |
|             |          |                   |                        |

##### 3.3.5 销售信息表 T_Sale

| 字段名   | 字段类型 | 含义                      | 备注 |
| -------- | -------- | ------------------------- | ---- |
| ppid     | TEXT     | 项目 产品/服务 对应记录ID |      |
| pid      | TEXT     | 项目ID                    |      |
| pdid     | TEXT     | 产品/服务编号             |      |
| pd_count | INTEGER  | 产品/服务数量             |      |



------



### 4 文档约定

#### 4.1 简写/缩写清单

| 简写/缩写 | 全称               | 中文含义               | 备注                                                         |
| --------- | ------------------ | ---------------------- | ------------------------------------------------------------ |
| pid       | project id         | 项目ID                 | 系统唯一标识一个项目                                         |
| pd_code   | product code       | 产品/服务代码          | OA中以产品代码表示                                           |
| pdid      | product id         | 产品/服务标识          | OA中以存货编号表示                                           |
| ppid      | project product id | 项目与产品/ 服务对应ID | 在系统中用于对应项目与产品，一般为一对多关系，每个ppid均对应一条历史记录 |
| sno       | staff no/seller no | 人员编号               |                                                              |
| UR        | user roles         | 用户角色               |                                                              |

 	 	 	 

​	

#### 4.2 常用符号

### ·√■□▲△▼▽◆◇●○★☆


